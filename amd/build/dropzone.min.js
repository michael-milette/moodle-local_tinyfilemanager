define ("local_tinyfilemanager/dropzone",["exports","just-extend","./emitter","./options"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.Dropzone=a.default=void 0;b=e(b);c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}function f(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){f=function(a){return typeof a}}else{f=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return f(a)}function g(a){if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(a=h(a))){var b=0,c=function(){};return{s:c,n:function n(){if(b>=a.length)return{done:!0};return{done:!1,value:a[b++]}},e:function e(a){throw a},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,e=!0,f=!1,g;return{s:function s(){d=a[Symbol.iterator]()},n:function n(){var a=d.next();e=a.done;return a},e:function e(a){f=!0;g=a},f:function f(){try{if(!e&&null!=d.return)d.return()}finally{if(f)throw g}}}}function h(a,b){if(!a)return;if("string"==typeof a)return i(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return i(a,b)}function i(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function j(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function k(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function l(a,b,c){if(b)k(a.prototype,b);if(c)k(a,c);return a}function m(a,b){if("function"!=typeof b&&null!==b){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});if(b)n(a,b)}function n(a,b){n=Object.setPrototypeOf||function(a,b){a.__proto__=b;return a};return n(a,b)}function o(a){return function(){var b=s(a),c;if(r()){var d=s(this).constructor;c=Reflect.construct(b,arguments,d)}else{c=b.apply(this,arguments)}return p(this,c)}}function p(a,b){if(b&&("object"===f(b)||"function"==typeof b)){return b}return q(a)}function q(a){if(void 0===a){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(a){return!1}}function s(a){s=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)};return s(a)}var v=function(a){m(f,a);var h=o(f);l(f,null,[{key:"initClass",value:function initClass(){this.prototype.Emitter=c.default;this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"];this.prototype._thumbnailQueue=[];this.prototype._processingThumbnail=!1}}]);function f(a,c){var e;j(this,f);e=h.call(this);var g,i;e.element=a;e.clickableElements=[];e.listeners=[];e.files=[];if("string"==typeof e.element){e.element=document.querySelector(e.element)}if(!e.element||null==e.element.nodeType){throw new Error("Invalid dropzone element.")}if(e.element.dropzone){throw new Error("Dropzone already attached.")}f.instances.push(q(e));e.element.dropzone=q(e);var k=null!=(i=f.optionsForElement(e.element))?i:{};e.options=(0,b.default)(!0,{},d.default,k,null!=c?c:{});e.options.previewTemplate=e.options.previewTemplate.replace(/\n*/g,"");if(e.options.forceFallback||!f.isBrowserSupported()){return p(e,e.options.fallback.call(q(e)))}if(null==e.options.url){e.options.url=e.element.getAttribute("action")}if(!e.options.url){throw new Error("No URL provided.")}if(e.options.acceptedFiles&&e.options.acceptedMimeTypes){throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.")}if(e.options.uploadMultiple&&e.options.chunking){throw new Error("You cannot set both: uploadMultiple and chunking.")}if(e.options.binaryBody&&e.options.uploadMultiple){throw new Error("You cannot set both: binaryBody and uploadMultiple.")}if(e.options.acceptedMimeTypes){e.options.acceptedFiles=e.options.acceptedMimeTypes;delete e.options.acceptedMimeTypes}if(null!=e.options.renameFilename){e.options.renameFile=function(a){return e.options.renameFilename.call(q(e),a.name,a)}}if("string"==typeof e.options.method){e.options.method=e.options.method.toUpperCase()}if((g=e.getExistingFallback())&&g.parentNode){g.parentNode.removeChild(g)}if(!1!==e.options.previewsContainer){if(e.options.previewsContainer){e.previewsContainer=f.getElement(e.options.previewsContainer,"previewsContainer")}else{e.previewsContainer=e.element}}if(e.options.clickable){if(!0===e.options.clickable){e.clickableElements=[e.element]}else{e.clickableElements=f.getElements(e.options.clickable,"clickable")}}e.init();return e}l(f,[{key:"getAcceptedFiles",value:function getAcceptedFiles(){return this.files.filter(function(a){return a.accepted}).map(function(a){return a})}},{key:"getRejectedFiles",value:function getRejectedFiles(){return this.files.filter(function(a){return!a.accepted}).map(function(a){return a})}},{key:"getFilesWithStatus",value:function getFilesWithStatus(a){return this.files.filter(function(b){return b.status===a}).map(function(a){return a})}},{key:"getQueuedFiles",value:function getQueuedFiles(){return this.getFilesWithStatus(f.QUEUED)}},{key:"getUploadingFiles",value:function getUploadingFiles(){return this.getFilesWithStatus(f.UPLOADING)}},{key:"getAddedFiles",value:function getAddedFiles(){return this.getFilesWithStatus(f.ADDED)}},{key:"getActiveFiles",value:function getActiveFiles(){return this.files.filter(function(a){return a.status===f.UPLOADING||a.status===f.QUEUED}).map(function(a){return a})}},{key:"init",value:function init(){var a=this;if("form"===this.element.tagName){this.element.setAttribute("enctype","multipart/form-data")}if(this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")){this.element.appendChild(f.createElement("<div class=\"dz-default dz-message\"><button class=\"dz-button\" type=\"button\">".concat(this.options.dictDefaultMessage,"</button></div>")))}if(this.clickableElements.length){var i=function(){if(a.hiddenFileInput){a.hiddenFileInput.parentNode.removeChild(a.hiddenFileInput)}a.hiddenFileInput=document.createElement("input");a.hiddenFileInput.setAttribute("type","file");if(null===a.options.maxFiles||1<a.options.maxFiles){a.hiddenFileInput.setAttribute("multiple","multiple")}a.hiddenFileInput.className="dz-hidden-input";if(null!==a.options.acceptedFiles){a.hiddenFileInput.setAttribute("accept",a.options.acceptedFiles)}if(null!==a.options.capture){a.hiddenFileInput.setAttribute("capture",a.options.capture)}a.hiddenFileInput.setAttribute("tabindex","-1");a.hiddenFileInput.style.visibility="hidden";a.hiddenFileInput.style.position="absolute";a.hiddenFileInput.style.top="0";a.hiddenFileInput.style.left="0";a.hiddenFileInput.style.height="0";a.hiddenFileInput.style.width="0";f.getElement(a.options.hiddenInputContainer,"hiddenInputContainer").appendChild(a.hiddenFileInput);a.hiddenFileInput.addEventListener("change",function(){var b=a.hiddenFileInput.files;if(b.length){var c=g(b),d;try{for(c.s();!(d=c.n()).done;){var e=d.value;a.addFile(e)}}catch(a){c.e(a)}finally{c.f()}}a.emit("addedfiles",b);i()})};i()}this.URL=null!==window.URL?window.URL:window.webkitURL;var b=g(this.events),c;try{for(b.s();!(c=b.n()).done;){var j=c.value;this.on(j,this.options[j])}}catch(a){b.e(a)}finally{b.f()}this.on("uploadprogress",function(){return a.updateTotalUploadProgress()});this.on("removedfile",function(){return a.updateTotalUploadProgress()});this.on("canceled",function(b){return a.emit("complete",b)});this.on("complete",function(){if(0===a.getAddedFiles().length&&0===a.getUploadingFiles().length&&0===a.getQueuedFiles().length){return setTimeout(function(){return a.emit("queuecomplete")},0)}});var d=function(a){if(a.dataTransfer.types){for(var b=0;b<a.dataTransfer.types.length;b++){if("Files"===a.dataTransfer.types[b])return!0}}return!1},h=function(a){if(!d(a))return;a.stopPropagation();if(a.preventDefault){return a.preventDefault()}else{return a.returnValue=!1}};this.listeners=[{element:this.element,events:{dragstart:function dragstart(b){return a.emit("dragstart",b)},dragenter:function dragenter(b){h(b);return a.emit("dragenter",b)},dragover:function dragover(b){var c;try{c=b.dataTransfer.effectAllowed}catch(a){}b.dataTransfer.dropEffect="move"===c||"linkMove"===c?"move":"copy";h(b);return a.emit("dragover",b)},dragleave:function dragleave(b){return a.emit("dragleave",b)},drop:function drop(b){h(b);return a.drop(b)},dragend:function dragend(b){return a.emit("dragend",b)}}}];this.clickableElements.forEach(function(b){return a.listeners.push({element:b,events:{click:function click(c){if(b!==a.element||c.target===a.element||f.elementInside(c.target,a.element.querySelector(".dz-message"))){a.hiddenFileInput.click()}return!0}}})});this.enable();return this.options.init.call(this)}},{key:"destroy",value:function destroy(){this.disable();this.removeAllFiles(!0);if(null!=this.hiddenFileInput?this.hiddenFileInput.parentNode:void 0){this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);this.hiddenFileInput=null}delete this.element.dropzone;return f.instances.splice(f.instances.indexOf(this),1)}},{key:"updateTotalUploadProgress",value:function updateTotalUploadProgress(){var a,b=0,c=0,d=this.getActiveFiles();if(d.length){var e=g(this.getActiveFiles()),f;try{for(e.s();!(f=e.n()).done;){var h=f.value;b+=h.upload.bytesSent;c+=h.upload.total}}catch(a){e.e(a)}finally{e.f()}a=100*b/c}else{a=100}return this.emit("totaluploadprogress",a,c,b)}},{key:"_getParamName",value:function _getParamName(a){if("function"==typeof this.options.paramName){return this.options.paramName(a)}else{return"".concat(this.options.paramName).concat(this.options.uploadMultiple?"[".concat(a,"]"):"")}}},{key:"_renameFile",value:function _renameFile(a){if("function"!=typeof this.options.renameFile){return a.name}return this.options.renameFile(a)}},{key:"getFallbackForm",value:function getFallbackForm(){var a,b;if(a=this.getExistingFallback()){return a}var c="<div class=\"dz-fallback\">";if(this.options.dictFallbackText){c+="<p>".concat(this.options.dictFallbackText,"</p>")}c+="<input type=\"file\" name=\"".concat(this._getParamName(0),"\" ").concat(this.options.uploadMultiple?"multiple=\"multiple\"":void 0," /><input type=\"submit\" value=\"Upload!\"></div>");var d=f.createElement(c);if("FORM"!==this.element.tagName){b=f.createElement("<form action=\"".concat(this.options.url,"\" enctype=\"multipart/form-data\" method=\"").concat(this.options.method,"\"></form>"));b.appendChild(d)}else{this.element.setAttribute("enctype","multipart/form-data");this.element.setAttribute("method",this.options.method)}return null!=b?b:d}},{key:"getExistingFallback",value:function getExistingFallback(){for(var a=function(a){var b=g(a),c;try{for(b.s();!(c=b.n()).done;){var d=c.value;if(/(^| )fallback($| )/.test(d.className)){return d}}}catch(a){b.e(a)}finally{b.f()}},b=0,c=["div","form"];b<c.length;b++){var d=c[b],e;if(e=a(this.element.getElementsByTagName(d))){return e}}}},{key:"setupEventListeners",value:function setupEventListeners(){return this.listeners.map(function(a){return function(){var b=[];for(var c in a.events){var d=a.events[c];b.push(a.element.addEventListener(c,d,!1))}return b}()})}},{key:"removeEventListeners",value:function removeEventListeners(){return this.listeners.map(function(a){return function(){var b=[];for(var c in a.events){var d=a.events[c];b.push(a.element.removeEventListener(c,d,!1))}return b}()})}},{key:"disable",value:function disable(){var a=this;this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")});this.removeEventListeners();this.disabled=!0;return this.files.map(function(b){return a.cancelUpload(b)})}},{key:"enable",value:function enable(){delete this.disabled;this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")});return this.setupEventListeners()}},{key:"filesize",value:function filesize(a){var b=0,c="b";if(0<a){for(var d=["tb","gb","mb","kb","b"],e=0;e<d.length;e++){var f=d[e],g=Math.pow(this.options.filesizeBase,4-e)/10;if(a>=g){b=a/Math.pow(this.options.filesizeBase,4-e);c=f;break}}b=Math.round(10*b)/10}return"<strong>".concat(b,"</strong> ").concat(this.options.dictFileSizeUnits[c])}},{key:"_updateMaxFilesReachedClass",value:function _updateMaxFilesReachedClass(){if(null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles){if(this.getAcceptedFiles().length===this.options.maxFiles){this.emit("maxfilesreached",this.files)}return this.element.classList.add("dz-max-files-reached")}else{return this.element.classList.remove("dz-max-files-reached")}}},{key:"drop",value:function drop(a){if(!a.dataTransfer){return}this.emit("drop",a);for(var b=[],c=0;c<a.dataTransfer.files.length;c++){b[c]=a.dataTransfer.files[c]}if(b.length){var d=a.dataTransfer.items;if(d&&d.length&&null!=d[0].webkitGetAsEntry){this._addFilesFromItems(d)}else{this.handleFiles(b)}}this.emit("addedfiles",b)}},{key:"paste",value:function paste(a){if(null==t(null!=a?a.clipboardData:void 0,function(a){return a.items})){return}this.emit("paste",a);var b=a.clipboardData.items;if(b.length){return this._addFilesFromItems(b)}}},{key:"handleFiles",value:function handleFiles(a){var b=g(a),c;try{for(b.s();!(c=b.n()).done;){var d=c.value;this.addFile(d)}}catch(a){b.e(a)}finally{b.f()}}},{key:"_addFilesFromItems",value:function _addFilesFromItems(a){var b=this;return function(){var c=[],d=g(a),e;try{for(d.s();!(e=d.n()).done;){var f=e.value,h;if(null!=f.webkitGetAsEntry&&(h=f.webkitGetAsEntry())){if(h.isFile){c.push(b.addFile(f.getAsFile()))}else if(h.isDirectory){c.push(b._addFilesFromDirectory(h,h.name))}else{c.push(void 0)}}else if(null!=f.getAsFile){if(null==f.kind||"file"===f.kind){c.push(b.addFile(f.getAsFile()))}else{c.push(void 0)}}else{c.push(void 0)}}}catch(a){d.e(a)}finally{d.f()}return c}()}},{key:"_addFilesFromDirectory",value:function _addFilesFromDirectory(a,b){var c=this,d=a.createReader(),e=function(a){return u(console,"log",function(b){return b.log(a)})},f=function(){return d.readEntries(function(a){if(0<a.length){var d=g(a),e;try{for(d.s();!(e=d.n()).done;){var h=e.value;if(h.isFile){h.file(function(a){if(c.options.ignoreHiddenFiles&&"."===a.name.substring(0,1)){return}a.fullPath="".concat(b,"/").concat(a.name);return c.addFile(a)})}else if(h.isDirectory){c._addFilesFromDirectory(h,"".concat(b,"/").concat(h.name))}}}catch(a){d.e(a)}finally{d.f()}f()}return null},e)};return f()}},{key:"accept",value:function accept(a,b){if(this.options.maxFilesize&&a.size>1024*(1024*this.options.maxFilesize)){b(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize))}else if(!f.isValidFile(a,this.options.acceptedFiles)){b(this.options.dictInvalidFileType)}else if(null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles){b(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles));this.emit("maxfilesexceeded",a)}else{this.options.accept.call(this,a,b)}}},{key:"addFile",value:function addFile(a){var b=this;a.upload={uuid:f.uuidv4(),progress:0,total:a.size,bytesSent:0,filename:this._renameFile(a)};this.files.push(a);a.status=f.ADDED;this.emit("addedfile",a);this._enqueueThumbnail(a);this.accept(a,function(c){if(c){a.accepted=!1;b._errorProcessing([a],c)}else{a.accepted=!0;if(b.options.autoQueue){b.enqueueFile(a)}}b._updateMaxFilesReachedClass()})}},{key:"enqueueFiles",value:function enqueueFiles(a){var b=g(a),c;try{for(b.s();!(c=b.n()).done;){var d=c.value;this.enqueueFile(d)}}catch(a){b.e(a)}finally{b.f()}return null}},{key:"enqueueFile",value:function enqueueFile(a){var b=this;if(a.status===f.ADDED&&!0===a.accepted){a.status=f.QUEUED;if(this.options.autoProcessQueue){return setTimeout(function(){return b.processQueue()},0)}}else{throw new Error("This file can't be queued because it has already been processed or was rejected.")}}},{key:"_enqueueThumbnail",value:function _enqueueThumbnail(a){var b=this;if(this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=1024*(1024*this.options.maxThumbnailFilesize)){this._thumbnailQueue.push(a);return setTimeout(function(){return b._processThumbnailQueue()},0)}}},{key:"_processThumbnailQueue",value:function _processThumbnailQueue(){var a=this;if(this._processingThumbnail||0===this._thumbnailQueue.length){return}this._processingThumbnail=!0;var b=this._thumbnailQueue.shift();return this.createThumbnail(b,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,function(c){a.emit("thumbnail",b,c);a._processingThumbnail=!1;return a._processThumbnailQueue()})}},{key:"removeFile",value:function removeFile(a){if(a.status===f.UPLOADING){this.cancelUpload(a)}this.files=w(this.files,a);this.emit("removedfile",a);if(0===this.files.length){return this.emit("reset")}}},{key:"removeAllFiles",value:function removeAllFiles(a){if(null==a){a=!1}var b=g(this.files.slice()),c;try{for(b.s();!(c=b.n()).done;){var d=c.value;if(d.status!==f.UPLOADING||a){this.removeFile(d)}}}catch(a){b.e(a)}finally{b.f()}return null}},{key:"resizeImage",value:function resizeImage(a,b,c,d,e){var g=this;return this.createThumbnail(a,b,c,d,!0,function(b,c){if(null==c){return e(a)}else{var d=g.options.resizeMimeType;if(null==d){d=a.type}var h=c.toDataURL(d,g.options.resizeQuality);if("image/jpeg"===d||"image/jpg"===d){h=A.restore(a.dataURL,h)}return e(f.dataURItoBlob(h))}})}},{key:"createThumbnail",value:function createThumbnail(a,b,c,d,e,f){var g=this,h=new FileReader;h.onload=function(){a.dataURL=h.result;if("image/svg+xml"===a.type){if(null!=f){f(h.result)}return}g.createThumbnailFromUrl(a,b,c,d,e,f)};h.readAsDataURL(a)}},{key:"displayExistingFile",value:function displayExistingFile(a,b,c,d){var e=this,f=4<arguments.length&&arguments[4]!==void 0?arguments[4]:!0;this.emit("addedfile",a);this.emit("complete",a);if(!f){this.emit("thumbnail",a,b);if(c)c()}else{a.dataURL=b;this.createThumbnailFromUrl(a,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,this.options.fixOrientation,function onDone(b){e.emit("thumbnail",a,b);if(c)c()},d)}}},{key:"createThumbnailFromUrl",value:function createThumbnailFromUrl(a,b,c,d,e,f,g){var h=this,i=document.createElement("img");if(g){i.crossOrigin=g}e="from-image"==getComputedStyle(document.body).imageOrientation?!1:e;i.onload=function(){var g=function(a){return a(1)};if("undefined"!=typeof EXIF&&null!==EXIF&&e){g=function(a){return EXIF.getData(i,function(){return a(EXIF.getTag(this,"Orientation"))})}}return g(function(e){a.width=i.width;a.height=i.height;var g=h.options.resize.call(h,a,b,c,d),j=document.createElement("canvas"),k=j.getContext("2d");j.width=g.trgWidth;j.height=g.trgHeight;if(4<e){j.width=g.trgHeight;j.height=g.trgWidth}switch(e){case 2:k.translate(j.width,0);k.scale(-1,1);break;case 3:k.translate(j.width,j.height);k.rotate(Math.PI);break;case 4:k.translate(0,j.height);k.scale(1,-1);break;case 5:k.rotate(.5*Math.PI);k.scale(1,-1);break;case 6:k.rotate(.5*Math.PI);k.translate(0,-j.width);break;case 7:k.rotate(.5*Math.PI);k.translate(j.height,-j.width);k.scale(-1,1);break;case 8:k.rotate(-.5*Math.PI);k.translate(-j.height,0);break;}z(k,i,null!=g.srcX?g.srcX:0,null!=g.srcY?g.srcY:0,g.srcWidth,g.srcHeight,null!=g.trgX?g.trgX:0,null!=g.trgY?g.trgY:0,g.trgWidth,g.trgHeight);var l=j.toDataURL("image/png");if(null!=f){return f(l,j)}})};if(null!=f){i.onerror=f}return i.src=a.dataURL}},{key:"processQueue",value:function processQueue(){var a=this.options.parallelUploads,b=this.getUploadingFiles().length,c=b;if(b>=a){return}var d=this.getQueuedFiles();if(!(0<d.length)){return}if(this.options.uploadMultiple){return this.processFiles(d.slice(0,a-b))}else{while(c<a){if(!d.length){return}this.processFile(d.shift());c++}}}},{key:"processFile",value:function processFile(a){return this.processFiles([a])}},{key:"processFiles",value:function processFiles(a){var b=g(a),c;try{for(b.s();!(c=b.n()).done;){var d=c.value;d.processing=!0;d.status=f.UPLOADING;this.emit("processing",d)}}catch(a){b.e(a)}finally{b.f()}if(this.options.uploadMultiple){this.emit("processingmultiple",a)}return this.uploadFiles(a)}},{key:"_getFilesWithXhr",value:function _getFilesWithXhr(a){var b;return b=this.files.filter(function(b){return b.xhr===a}).map(function(a){return a})}},{key:"cancelUpload",value:function cancelUpload(a){if(a.status===f.UPLOADING){var b=this._getFilesWithXhr(a.xhr),c=g(b),d;try{for(c.s();!(d=c.n()).done;){var i=d.value;i.status=f.CANCELED}}catch(a){c.e(a)}finally{c.f()}if("undefined"!=typeof a.xhr){a.xhr.abort()}var e=g(b),h;try{for(e.s();!(h=e.n()).done;){var j=h.value;this.emit("canceled",j)}}catch(a){e.e(a)}finally{e.f()}if(this.options.uploadMultiple){this.emit("canceledmultiple",b)}}else if(a.status===f.ADDED||a.status===f.QUEUED){a.status=f.CANCELED;this.emit("canceled",a);if(this.options.uploadMultiple){this.emit("canceledmultiple",[a])}}if(this.options.autoProcessQueue){return this.processQueue()}}},{key:"resolveOption",value:function resolveOption(a){if("function"==typeof a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++){c[d-1]=arguments[d]}return a.apply(this,c)}return a}},{key:"uploadFile",value:function uploadFile(a){return this.uploadFiles([a])}},{key:"uploadFiles",value:function uploadFiles(a){var b=this;this._transformFiles(a,function(c){if(b.options.chunking){var k=c[0];a[0].upload.chunked=b.options.chunking&&(b.options.forceChunking||k.size>b.options.chunkSize);a[0].upload.totalChunkCount=Math.ceil(k.size/b.options.chunkSize)}if(a[0].upload.chunked){var d=a[0],e=c[0],g=0;d.upload.chunks=[];var l=function(){var c=0;while(d.upload.chunks[c]!==void 0){c++}if(c>=d.upload.totalChunkCount)return;g++;var h=c*b.options.chunkSize,i=Math.min(h+b.options.chunkSize,e.size),j={name:b._getParamName(0),data:e.webkitSlice?e.webkitSlice(h,i):e.slice(h,i),filename:d.upload.filename,chunkIndex:c};d.upload.chunks[c]={file:d,index:c,dataBlock:j,status:f.UPLOADING,progress:0,retries:0};b._uploadData(a,[j])};d.upload.finishedChunkUpload=function(c,e){var g=!0;c.status=f.SUCCESS;c.dataBlock=null;c.response=c.xhr.responseText;c.responseHeaders=c.xhr.getAllResponseHeaders();c.xhr=null;for(var h=0;h<d.upload.totalChunkCount;h++){if(d.upload.chunks[h]===void 0){return l()}if(d.upload.chunks[h].status!==f.SUCCESS){g=!1}}if(g){b.options.chunksUploaded(d,function(){b._finished(a,e,null)})}};if(b.options.parallelChunkUploads){for(var m=0;m<d.upload.totalChunkCount;m++){l()}}else{l()}}else{for(var h=[],j=0;j<a.length;j++){h[j]={name:b._getParamName(j),data:c[j],filename:a[j].upload.filename}}b._uploadData(a,h)}})}},{key:"_getChunk",value:function _getChunk(a,b){for(var c=0;c<a.upload.totalChunkCount;c++){if(a.upload.chunks[c]!==void 0&&a.upload.chunks[c].xhr===b){return a.upload.chunks[c]}}}},{key:"_uploadData",value:function _uploadData(a,c){var d=this,f=new XMLHttpRequest,h=g(a),j;try{for(h.s();!(j=h.n()).done;){var t=j.value;t.xhr=f}}catch(a){h.e(a)}finally{h.f()}if(a[0].upload.chunked){a[0].upload.chunks[c[0].chunkIndex].xhr=f}var k=this.resolveOption(this.options.method,a,c),l=this.resolveOption(this.options.url,a,c);f.open(k,l,!0);var m=this.resolveOption(this.options.timeout,a);if(m)f.timeout=this.resolveOption(this.options.timeout,a);f.withCredentials=!!this.options.withCredentials;f.onload=function(b){d._finishedUploading(a,f,b)};f.ontimeout=function(){d._handleUploadError(a,f,"Request timedout after ".concat(d.options.timeout/1e3," seconds"))};f.onerror=function(){d._handleUploadError(a,f)};var n=null!=f.upload?f.upload:f;n.onprogress=function(b){return d._updateFilesUploadProgress(a,f,b)};var o=this.options.defaultHeaders?{Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"}:{};if(this.options.binaryBody){o["Content-Type"]=a[0].type}if(this.options.headers){(0,b.default)(o,this.options.headers)}for(var u in o){var v=o[u];if(v){f.setRequestHeader(u,v)}}if(this.options.binaryBody){var p=g(a),q;try{for(p.s();!(q=p.n()).done;){var w=q.value;this.emit("sending",w,f)}}catch(a){p.e(a)}finally{p.f()}if(this.options.uploadMultiple){this.emit("sendingmultiple",a,f)}this.submitRequest(f,null,a)}else{var x=new FormData;if(this.options.params){var y=this.options.params;if("function"==typeof y){y=y.call(this,a,f,a[0].upload.chunked?this._getChunk(a[0],f):null)}for(var z in y){var A=y[z];if(Array.isArray(A)){for(var B=0;B<A.length;B++){x.append(z,A[B])}}else{x.append(z,A)}}}var r=g(a),s;try{for(r.s();!(s=r.n()).done;){var e=s.value;this.emit("sending",e,f,x)}}catch(a){r.e(a)}finally{r.f()}if(this.options.uploadMultiple){this.emit("sendingmultiple",a,f,x)}this._addFormElementData(x);for(var i=0,C;i<c.length;i++){C=c[i];x.append(C.name,C.data,C.filename)}this.submitRequest(f,x,a)}}},{key:"_transformFiles",value:function _transformFiles(a,b){for(var c=this,d=[],e=0,f=function(f){c.options.transformFile.call(c,a[f],function(c){d[f]=c;if(++e===a.length){b(d)}})},g=0;g<a.length;g++){f(g)}}},{key:"_addFormElementData",value:function _addFormElementData(a){if("FORM"===this.element.tagName){var b=g(this.element.querySelectorAll("input, textarea, select, button")),c;try{for(b.s();!(c=b.n()).done;){var d=c.value,e=d.getAttribute("name"),f=d.getAttribute("type");if(f)f=f.toLowerCase();if("undefined"==typeof e||null===e)continue;if("SELECT"===d.tagName&&d.hasAttribute("multiple")){var h=g(d.options),i;try{for(h.s();!(i=h.n()).done;){var j=i.value;if(j.selected){a.append(e,j.value)}}}catch(a){h.e(a)}finally{h.f()}}else if(!f||"checkbox"!==f&&"radio"!==f||d.checked){a.append(e,d.value)}}}catch(a){b.e(a)}finally{b.f()}}}},{key:"_updateFilesUploadProgress",value:function _updateFilesUploadProgress(a,b,c){if(!a[0].upload.chunked){var d=g(a),e;try{for(d.s();!(e=d.n()).done;){var j=e.value;if(j.upload.total&&j.upload.bytesSent&&j.upload.bytesSent==j.upload.total){continue}if(c){j.upload.progress=100*c.loaded/c.total;j.upload.total=c.total;j.upload.bytesSent=c.loaded}else{j.upload.progress=100;j.upload.bytesSent=j.upload.total}this.emit("uploadprogress",j,j.upload.progress,j.upload.bytesSent)}}catch(a){d.e(a)}finally{d.f()}}else{var f=a[0],h=this._getChunk(f,b);if(c){h.progress=100*c.loaded/c.total;h.total=c.total;h.bytesSent=c.loaded}else{h.progress=100;h.bytesSent=h.total}f.upload.progress=0;f.upload.total=0;f.upload.bytesSent=0;for(var k=0;k<f.upload.totalChunkCount;k++){if(f.upload.chunks[k]&&"undefined"!=typeof f.upload.chunks[k].progress){f.upload.progress+=f.upload.chunks[k].progress;f.upload.total+=f.upload.chunks[k].total;f.upload.bytesSent+=f.upload.chunks[k].bytesSent}}f.upload.progress=f.upload.progress/f.upload.totalChunkCount;this.emit("uploadprogress",f,f.upload.progress,f.upload.bytesSent)}}},{key:"_finishedUploading",value:function _finishedUploading(a,b,c){var d;if(a[0].status===f.CANCELED){return}if(4!==b.readyState){return}if("arraybuffer"!==b.responseType&&"blob"!==b.responseType){d=b.responseText;if(b.getResponseHeader("content-type")&&~b.getResponseHeader("content-type").indexOf("application/json")){try{d=JSON.parse(d)}catch(a){c=a;d="Invalid JSON response from server."}}}this._updateFilesUploadProgress(a,b);if(!(200<=b.status&&300>b.status)){this._handleUploadError(a,b,d)}else{if(a[0].upload.chunked){a[0].upload.finishedChunkUpload(this._getChunk(a[0],b),d)}else{this._finished(a,d,c)}}}},{key:"_handleUploadError",value:function _handleUploadError(a,b,c){if(a[0].status===f.CANCELED){return}if(a[0].upload.chunked&&this.options.retryChunks){var d=this._getChunk(a[0],b);if(d.retries++<this.options.retryChunksLimit){this._uploadData(a,[d.dataBlock]);return}else{console.warn("Retried this chunk too often. Giving up.")}}this._errorProcessing(a,c||this.options.dictResponseError.replace("{{statusCode}}",b.status),b)}},{key:"submitRequest",value:function submitRequest(a,b,c){if(1!=a.readyState){console.warn("Cannot send this request because the XMLHttpRequest.readyState is not OPENED.");return}if(this.options.binaryBody){if(c[0].upload.chunked){var d=this._getChunk(c[0],a);a.send(d.dataBlock.data)}else{a.send(c[0])}}else{a.send(b)}}},{key:"_finished",value:function _finished(a,b,c){var d=g(a),e;try{for(d.s();!(e=d.n()).done;){var h=e.value;h.status=f.SUCCESS;this.emit("success",h,b,c);this.emit("complete",h)}}catch(a){d.e(a)}finally{d.f()}if(this.options.uploadMultiple){this.emit("successmultiple",a,b,c);this.emit("completemultiple",a)}if(this.options.autoProcessQueue){return this.processQueue()}}},{key:"_errorProcessing",value:function _errorProcessing(a,b,c){var d=g(a),e;try{for(d.s();!(e=d.n()).done;){var h=e.value;h.status=f.ERROR;this.emit("error",h,b,c);this.emit("complete",h)}}catch(a){d.e(a)}finally{d.f()}if(this.options.uploadMultiple){this.emit("errormultiple",a,b,c);this.emit("completemultiple",a)}if(this.options.autoProcessQueue){return this.processQueue()}}}],[{key:"uuidv4",value:function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"===a?b:8|3&b;return c.toString(16)})}}]);return f}(c.default);a.Dropzone=a.default=v;v.initClass();v.options={};v.optionsForElement=function(a){if(a.getAttribute("id")){return v.options[x(a.getAttribute("id"))]}else{}};v.instances=[];v.forElement=function(a){if("string"==typeof a){a=document.querySelector(a)}if(null==(null!=a?a.dropzone:void 0)){throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.")}return a.dropzone};v.discover=function(){var a;if(document.querySelectorAll){a=document.querySelectorAll(".dropzone")}else{a=[];var b=function(b){return function(){var c=[],d=g(b),e;try{for(d.s();!(e=d.n()).done;){var f=e.value;if(/(^| )dropzone($| )/.test(f.className)){c.push(a.push(f))}else{c.push(void 0)}}}catch(a){d.e(a)}finally{d.f()}return c}()};b(document.getElementsByTagName("div"));b(document.getElementsByTagName("form"))}return function(){var b=[],c=g(a),d;try{for(c.s();!(d=c.n()).done;){var e=d.value;if(!1!==v.optionsForElement(e)){b.push(new v(e))}else{b.push(void 0)}}}catch(a){c.e(a)}finally{c.f()}return b}()};v.blockedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i];v.isBrowserSupported=function(){var a=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector){if(!("classList"in document.createElement("a"))){a=!1}else{if(v.blacklistedBrowsers!==void 0){v.blockedBrowsers=v.blacklistedBrowsers}var b=g(v.blockedBrowsers),c;try{for(b.s();!(c=b.n()).done;){var d=c.value;if(d.test(navigator.userAgent)){a=!1;continue}}}catch(a){b.e(a)}finally{b.f()}}}else{a=!1}return a};v.dataURItoBlob=function(a){for(var b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=new ArrayBuffer(b.length),e=new Uint8Array(d),f=0,g=b.length,h=0<=g;h?f<=g:f>=g;h?f++:f--){e[f]=b.charCodeAt(f)}return new Blob([d],{type:c})};var w=function(a,b){return a.filter(function(a){return a!==b}).map(function(a){return a})},x=function(a){return a.replace(/[\-_](\w)/g,function(a){return a.charAt(1).toUpperCase()})};v.createElement=function(a){var b=document.createElement("div");b.innerHTML=a;return b.childNodes[0]};v.elementInside=function(a,b){if(a===b){return!0}while(a=a.parentNode){if(a===b){return!0}}return!1};v.getElement=function(a,b){var c;if("string"==typeof a){c=document.querySelector(a)}else if(null!=a.nodeType){c=a}if(null==c){throw new Error("Invalid `".concat(b,"` option provided. Please provide a CSS selector or a plain HTML element."))}return c};v.getElements=function(a,b){var c,d;if(a instanceof Array){d=[];try{var e=g(a),f;try{for(e.s();!(f=e.n()).done;){c=f.value;d.push(this.getElement(c,b))}}catch(a){e.e(a)}finally{e.f()}}catch(a){d=null}}else if("string"==typeof a){d=[];var h=g(document.querySelectorAll(a)),i;try{for(h.s();!(i=h.n()).done;){c=i.value;d.push(c)}}catch(a){h.e(a)}finally{h.f()}}else if(null!=a.nodeType){d=[a]}if(null==d||!d.length){throw new Error("Invalid `".concat(b,"` option provided. Please provide a CSS selector, a plain HTML element or a list of those."))}return d};v.confirm=function(a,b,c){if(window.confirm(a)){return b()}else if(null!=c){return c()}};v.isValidFile=function(a,b){if(!b){return!0}b=b.split(",");var c=a.type,d=c.replace(/\/.*$/,""),e=g(b),f;try{for(e.s();!(f=e.n()).done;){var h=f.value;h=h.trim();if("."===h.charAt(0)){if(-1!==a.name.toLowerCase().indexOf(h.toLowerCase(),a.name.length-h.length)){return!0}}else if(/\/\*$/.test(h)){if(d===h.replace(/\/.*$/,"")){return!0}}else{if(c===h){return!0}}}}catch(a){e.e(a)}finally{e.f()}return!1};if("undefined"!=typeof jQuery&&null!==jQuery){jQuery.fn.dropzone=function(a){return this.each(function(){return new v(this,a)})}}v.ADDED="added";v.QUEUED="queued";v.ACCEPTED=v.QUEUED;v.UPLOADING="uploading";v.PROCESSING=v.UPLOADING;v.CANCELED="canceled";v.ERROR="error";v.SUCCESS="success";var y=function(a){var b=a.naturalWidth,c=a.naturalHeight,d=document.createElement("canvas");d.width=1;d.height=c;var e=d.getContext("2d");e.drawImage(a,0,0);var f=e.getImageData(1,0,1,c),g=f.data,h=0,i=c,j=c;while(j>h){var l=g[4*(j-1)+3];if(0===l){i=j}else{h=j}j=i+h>>1}var k=j/c;if(0==k){return 1}else{return k}},z=function(a,b,c,d,e,f,g,h,i,j){var k=y(b);return a.drawImage(b,c,d,e,f,g,h,i,j/k)},A=function(){function a(){j(this,a)}l(a,null,[{key:"initClass",value:function initClass(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}},{key:"encode64",value:function encode64(a){var b="",c=void 0,d=void 0,e="",f=void 0,g=void 0,h=void 0,j="",k=0;while(!0){c=a[k++];d=a[k++];e=a[k++];f=c>>2;g=(3&c)<<4|d>>4;h=(15&d)<<2|e>>6;j=63&e;if(isNaN(d)){h=j=64}else if(isNaN(e)){j=64}b=b+this.KEY_STR.charAt(f)+this.KEY_STR.charAt(g)+this.KEY_STR.charAt(h)+this.KEY_STR.charAt(j);c=d=e="";f=g=h=j="";if(!(k<a.length)){break}}return b}},{key:"restore",value:function restore(a,b){if(!a.match("data:image/jpeg;base64,")){return b}var c=this.decode64(a.replace("data:image/jpeg;base64,","")),d=this.slice2Segments(c),e=this.exifManipulation(b,d);return"data:image/jpeg;base64,".concat(this.encode64(e))}},{key:"exifManipulation",value:function exifManipulation(a,b){var c=this.getExifArray(b),d=this.insertExif(a,c),e=new Uint8Array(d);return e}},{key:"getExifArray",value:function getExifArray(a){var b=void 0,c=0;while(c<a.length){b=a[c];if(255===b[0]&225===b[1]){return b}c++}return[]}},{key:"insertExif",value:function insertExif(a,b){var c=a.replace("data:image/jpeg;base64,",""),d=this.decode64(c),e=d.indexOf(255,3),f=d.slice(0,e),g=d.slice(e),h=f;h=h.concat(b);h=h.concat(g);return h}},{key:"slice2Segments",value:function slice2Segments(a){var b=0,c=[];while(!0){var d;if(255===a[b]&218===a[b+1]){break}if(255===a[b]&216===a[b+1]){b+=2}else{d=256*a[b+2]+a[b+3];var e=b+d+2,f=a.slice(b,e);c.push(f);b=e}if(b>a.length){break}}return c}},{key:"decode64",value:function decode64(a){var b=void 0,c=void 0,d="",e=void 0,f=void 0,g=void 0,h="",j=0,k=[];if(/[^A-Za-z0-9\+\/\=]/g.exec(a)){console.warn("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.")}a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(!0){e=this.KEY_STR.indexOf(a.charAt(j++));f=this.KEY_STR.indexOf(a.charAt(j++));g=this.KEY_STR.indexOf(a.charAt(j++));h=this.KEY_STR.indexOf(a.charAt(j++));b=e<<2|f>>4;c=(15&f)<<4|g>>2;d=(3&g)<<6|h;k.push(b);if(64!==g){k.push(c)}if(64!==h){k.push(d)}b=c=d="";e=f=g=h="";if(!(j<a.length)){break}}return k}}]);return a}();A.initClass();function t(a,b){return"undefined"!=typeof a&&null!==a?b(a):void 0}function u(a,b,c){if("undefined"!=typeof a&&null!==a&&"function"==typeof a[b]){return c(a,b)}else{}}return a.default});
//# sourceMappingURL=dropzone.min.js.map
